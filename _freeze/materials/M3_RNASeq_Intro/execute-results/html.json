{
  "hash": "84c490bd96177c2ab3a8258ba3120155",
  "result": {
    "markdown": "---\nformat: \n  revealjs:\n    navigation-mode: vertical\n    slide-number: false\n    width: 1600\n    height: 900\n    logo: \"images/revelo.png\"\n    footer: \"[home page](https://mchiapello.github.io/202304_REVELO_Torvergata/)\"\n    css: [\"css/theme.css\", \"css/custom.css\"]\n    theme: simple\n    controls: true\nmainfont: \"Times New Roman\"\neditor: source\nfilters:\n  - roughnotation\neditor_options: \n  chunk_output_type: inline\n---\n\n\n<style>\n  @import url('https://fonts.googleapis.com/css2?family=Architects+Daughter&family=Julius+Sans+One&family=Montserrat:wght@300&family=Rock+Salt&display=swap');\n</style>\n\n##  {#TitleSlide data-menu-title=\"TitleSlide\" background-image=\"images/back001.jpg\" background-size=\"cover\" background-opacity=\"0.3\"}\n\n\n\n\n\n::: {style=\"position: absolute; left: 180px; top: 200px; height: 525px; width: 1500px; background-color: #69b1e9; padding: 20px; padding-left: 50px; border-radius: 5px;\"}\n[Introduzione all'RNASeq]{style=\"font-size: 120px; font-weight: bold; line-height: 1em; margin: 0px; font-family: 'Architects Daughter', cursive;\"}\n\n[Introduzione all'analisi RNASeq in R]{style=\"font-size: 40px;font-weight: bold;\"}\n\n[Dipartimento di Biomedicina e Prevenzione]{style=\"font-size: 40px;font-weight: bold;\"}\n\n<br> <br>\n\n[Marco Chiapello, Revelo Datalab]{style=\"font-size: 40px; font-weight: bold;\"}\n\n[2023-03-31]{style=\"font-size: 30px;font-weight: bold;\"}\n:::\n\n#  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\"}\n\n[How many samples do I need?]{.tit .p-span-center}\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\" auto-animate=\"true\"}\n\n::: {style=\"font-size: 80px; text-align: center\"}\nPower analysis\n:::\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\" auto-animate=\"true\"}\n\n::: {style=\"font-size: 80px; text-align: center\"}\nPower analysis\n:::\n\n-   **Type I error**: controlled by the α value. Often set to 0.01 (1%) or 0.001 (0.1%) in RNA-seq experiments.\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\" auto-animate=\"true\"}\n\n::: {style=\"font-size: 80px; text-align: center\"}\nPower analysis\n:::\n\n-   **Type I error**: controlled by the α value. Often set to 0.01 (1%) or 0.001 (0.1%) in RNA-seq experiments.\n\n-   **Type II error**: controlled by the β value. (1−β) will give you the power of your analysis. Should be set to 70 or 80% to detect 70 or 80% of the differentially expressed genes. The number of biological replicates might be hard to reach in practice for RNA-seq experiments.\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\" auto-animate=\"true\"}\n\n::: {style=\"font-size: 80px; text-align: center\"}\nPower analysis\n:::\n\n-   **Type I error**: controlled by the α value. Often set to 0.01 (1%) or 0.001 (0.1%) in RNA-seq experiments.\n\n-   **Type II error**: controlled by the β value. (1−β) will give you the power of your analysis. Should be set to 70 or 80% to detect 70 or 80% of the differentially expressed genes. The number of biological replicates might be hard to reach in practice for RNA-seq experiments.\n\n-   **Effect size**: this is a parameter you will set. For instance, if you want to investigate genes that differ between treatments with a difference of their mean of 2 then the effect size is equal to 2.\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\" auto-animate=\"true\"}\n\n::: {style=\"font-size: 80px; text-align: center\"}\nPower analysis\n:::\n\n-   **Type I error**: controlled by the α value. Often set to 0.01 (1%) or 0.001 (0.1%) in RNA-seq experiments.\n\n-   **Type II error**: controlled by the β value. (1−β) will give you the power of your analysis. Should be set to 70 or 80% to detect 70 or 80% of the differentially expressed genes. The number of biological replicates might be hard to reach in practice for RNA-seq experiments.\n\n-   **Effect size**: this is a parameter you will set. For instance, if you want to investigate genes that differ between treatments with a difference of their mean of 2 then the effect size is equal to 2.\n\n-   **Sample size**: the quantity you want to calculate.\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\"}\n\n#### Let's say we want:\n\n-   Type I error of 5%. (α=0.05)\n-   Type II error of 0.2. (Power=1−β=0.8)\n-   Effect size of 2. (d=2)\n\n::: {.fragment .fade-in}\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"1|3|4|5|1-7\"}\nlibrary(\"pwr\")\n\npwr.t.test(d = 2,\n           power = .8,\n           sig.level = .05,\n           type = \"two.sample\",\n           alternative = \"two.sided\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n     Two-sample t test power calculation \n\n              n = 5.089995\n              d = 2\n      sig.level = 0.05\n          power = 0.8\n    alternative = two.sided\n\nNOTE: n is number in *each* group\n```\n:::\n:::\n\n:::\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\"}\n\n#### Let's say we want:\n\n-   Effect size of 1. (d=1)\n\n::: {.fragment .fade-in}\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"pwr\")\n\npwr.t.test(d = 1,\n           power = .8,\n           sig.level = .05,\n           type = \"two.sample\",\n           alternative = \"two.sided\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n     Two-sample t test power calculation \n\n              n = 16.71472\n              d = 1\n      sig.level = 0.05\n          power = 0.8\n    alternative = two.sided\n\nNOTE: n is number in *each* group\n```\n:::\n:::\n\n:::\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\"}\n\n[Power analysis for RNA-seq]{.tit .p-span-center}\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\" auto-animate=\"true\"}\n\n::: {style=\"font-size: 60px; text-align:center\"}\n**General Considerations**\n:::\n\n<br>\n\n::: {style=\"font-size: 60px\"}\nRNA-seq experiments often suffer from a low statistical power\n:::\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\" auto-animate=\"true\"}\n\n::: {style=\"font-size: 60px; text-align:center\"}\n**General Considerations**\n:::\n\n<br>\n\n::: {style=\"font-size: 60px\"}\nRNA-seq experiments often suffer from a low statistical power\n:::\n\n<br>\n\n::: {style=\"font-size: 60px\"}\nLow power can lead to a lack of reproducibility of the research findings\n:::\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\" auto-animate=\"true\"}\n\n::: {style=\"font-size: 60px; text-align:center\"}\n**General Considerations**\n:::\n\n<br>\n\n::: {style=\"font-size: 60px\"}\nRNA-seq experiments often suffer from a low statistical power\n:::\n\n<br>\n\n::: {style=\"font-size: 60px\"}\nLow power can lead to a lack of reproducibility of the research findings\n:::\n\n<br>\n\n::: {style=\"font-size: 60px\"}\nThe number of replicates is one of the critical parameter related to the power of an analysis\n:::\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\"}\n\n[Replicates]{.tit .p-span-center}\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\"}\n\n![Klaus B., EMBO J (2015) 34: 2727-2730](images/image-259602676.png)\n\n::: notes\n-   Technical replicates: use the same biological sample to repeat the technical or experimental steps in order to accurately measure technical variation and remove it during analysis.\n\n-   Biological replicates use different biological samples of the same condition to measure the biological variation between samples\n:::\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\"}\n\n[Do we need technical replicates?]{.tit .p-span-center}\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\" auto-animate=\"true\"}\n\n[No]{.tit .p-span-center}\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\" auto-animate=\"true\"}\n\n[No]{.tit .p-span-center}\n\n::: callout-important\n[With the current RNA-Seq technologies, technical variation is much lower than biological variation and]{.f40}[technical replicates are unneccessary]{.rn}\n:::\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\"}\n\n[Do we need biological replicates?]{.tit .p-span-center}\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\" auto-animate=\"true\"}\n\n[YES]{.tit .p-span-center}\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\" auto-animate=\"true\"}\n\n[YES]{.tit .p-span-center}\n\n::: callout-important\n[Biological replicates are absolutely essential for [differential expression analysis]{.rn}]{.f40}\n:::\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\" auto-animate=\"true\"}\n\n[YES]{.tit .p-span-center}\n\n::: callout-important\n[For differential expression analysis, the more biological replicates, the better the estimates of biological variation and the more precise our estimates of the mean expression levels]{.f40}\n:::\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\"}\n\n::: {.f40 .tcenter .fragment}\nBiological replicates are of greater importance than sequencing depth\n:::\n\n![Liu, Y., et al., Bioinformatics (2014) 30(3): 301--304](images/image-154795781.png){width=\"auto\" height=\"700\"}\n\n:::{.notes}\n[Cosa vedete? Come interpretate il grafico]{style=\"font-size: 50px; color: red\"}\n\nNote that an increase in the number of replicates tends to return more DE genes than increasing the sequencing depth. \n:::\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\"}\n\n:::{style=\"font-size: 60px; text-align: center\"}\n**Replicates are almost always preferred to greater sequencing depth for bulk RNA-Seq**\n:::\n\n<br>\n\n:::{.callout-important}\nHowever, guidelines depend on the experiment performed and the desired analysis.\n:::\n\n:::{.fragment .fade-in fragment-index=1}\nHere some examples: \n:::\n\n:::{.fragment .fade-in fragment-index=1}\n:::{style=\"font-size: 30px\"}\n**General gene-level differential expression**    \n    - ENCODE guidelines suggest 30 million SE reads per sample (stranded).    \n    - 15 million reads per sample is often sufficient, if there are a good number of replicates (>3).    \n    - Spend money on more biological replicates, if possible.    \n    - Generally recommended to have read length >= 50 bp    \n:::\n:::\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\"}\n\n:::{style=\"font-size: 60px; text-align: center\"}\n**Replicates are almost always preferred to greater sequencing depth for bulk RNA-Seq**\n:::\n\n<br>\n\n:::{.callout-important}\nHowever, guidelines depend on the experiment performed and the desired analysis.\n:::\n\nHere some examples: \n\n:::{style=\"font-size: 30px\"}\n**Gene-level differential expression with detection of lowly-expressed genes**     \n    - Similarly benefits from replicates more than sequencing depth.     \n    - Sequence deeper with at least 30-60 million reads depending on level of expression (start with 30 million with a good number of replicates).\n    - Generally recommended to have read length >= 50 bp     \n:::\n\n##  {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\"}\n\n:::{style=\"font-size: 60px; text-align: center\"}\n**Replicates are almost always preferred to greater sequencing depth for bulk RNA-Seq**\n:::\n\n<br>\n\n:::{.callout-important}\nHowever, guidelines depend on the experiment performed and the desired analysis.\n:::\n\nHere some examples: \n\n:::{style=\"font-size: 30px\"}\n**Isoform-level differential expression**    \n    - Of known isoforms, suggested to have a depth of at least 30 million reads per sample and paired-end reads.    \n    - Of novel isoforms should have more depth (> 60 million reads per sample).    \n    - Choose biological replicates over paired/deeper sequencing.    \n    - Generally recommended to have read length >= 50 bp, but longer is better as the reads will be more likely to cross exon junctions    \n    - Perform careful QC of RNA quality. Be careful to use high quality preparation methods and restrict analysis to high quality RIN # samples.    \n:::\n\n\n## {background-image=\"images/stat001.jpg\" background-size=\"cover\" background-opacity=\"0.1\" auto-animtate=\"true\"}\n\n:::{style=\"font-size: 60px; text-align: center\"}\n**Principles of a good experimental design**\n:::\n\n:::{.fragment .fade-in fragment-index=1}\n**Randomization** \n\nThis should remove undesired and sometimes unknown bias coming from an unidentified source of variation (e.g. different temperatures in the same greehouse).\n:::\n\n:::{.fragment .fade-in fragment-index=2}\n\n**Replication** \n\nBy repeating the same minimal experiment more than once, you can estimate the error due to the experimenter manipulation and your treatment effect.\n\n:::\n\n:::{.fragment .fade-in fragment-index=3}\n\n**Blocking** \n\nCan help to reduce variability unexplained in one’s model. If your group consist of male and female individual, there is a chance that they will not respond in the same way to a given treatment. Therefore, “sex” should be a blocking factor in this case. \n\n:::\n\n#  {background-image=\"images/app001.jpg\" background-size=\"cover\" background-opacity=\"0.2\"}\n\n[Applications]{.tit .p-span-center}\n\n\n##  {background-image=\"images/app001.jpg\" background-size=\"cover\" background-opacity=\"0.2\"}\n\n::: {style=\"font-size: 80px; text-align: center\"}\nDiagnostics and disease profiling\n:::\n\n<br>\n<br>\n\n:::{.fragment .fade-down}\n::: {style=\"font-size: 60px\"}\n\n1. Transcriptional start sites\n\n1. Uncovered alternative promoter usage\n\n1. Novel splicing alterations\n:::\n:::\n\n::: footer\nLowe et al., 2017\n:::\n\n:::{.notes}\nRNA-Seq approaches have allowed for the large-scale identification of\n:::\n\n##  {background-image=\"images/app001.jpg\" background-size=\"cover\" background-opacity=\"0.2\"}\n\n::: {style=\"font-size: 80px; text-align: center\"}\nHuman and pathogen transcriptomes\n:::\n\n<br>\n<br>\n\n:::{.fragment .fade-down}\n::: {style=\"font-size: 60px\"}\n\n1. Quantifying gene expression changes\n\n1. Identifying novel virulence factors\n\n1. Predicting antibiotic resistance\n\n1. Unveiling host-pathogen immune interactions\n:::\n:::\n\n::: footer\nLowe et al., 2017\n:::\n\n:::{.notes}\nA **primary aim** of this technology is to develop **individualised treatment**\n\nRNA-Seq of human pathogens has become an established method for\n:::\n\n\n##  {background-image=\"images/app001.jpg\" background-size=\"cover\" background-opacity=\"0.2\"}\n\n::: {style=\"font-size: 80px; text-align: center\"}\nResponses to environment\n:::\n\n<br>\n\n\n:::{.fragment .fade-down}\n::: {style=\"font-size: 60px\"}\n\n1. Transcriptomics allows for the identification of genes and pathways that respond to biotic and abiotic environmental stresses\n\n1. The nontargeted nature of transcriptomics allows for the identification of novel transcriptional networks in complex systems\n\n1. [RNA-virus identification for pathogen containment]{.rn}\n:::\n:::\n\n::: footer\nLowe et al., 2017\n:::\n\n\n##  {background-image=\"images/app001.jpg\" background-size=\"cover\" background-opacity=\"0.2\"}\n\n::: {style=\"font-size: 80px; text-align: center\"}\nGene function annotation\n:::\n\n\n:::{.fragment .fade-down}\n::: {style=\"font-size: 60px\"}\n\n1. All transcriptomic techniques have been particularly useful in identifying the functions of genes and identifying those responsible for particular phenotypes\n\n1. Assembly of RNA-Seq reads is not dependent on a reference genome [104], and it is so ideal for gene expression studies of nonmodel organisms\n\n1. RNA-Seq can also be used to identify previously unknown protein coding regions in existing sequenced genomes\n:::\n:::\n\n::: footer\nLowe et al., 2017\n:::\n\n##  {background-image=\"images/app001.jpg\" background-size=\"cover\" background-opacity=\"0.2\"}\n\n::: {style=\"font-size: 80px; text-align: center\"}\nNoncoding RNA\n:::\n\n:::{.fragment .fade-down}\n::: {style=\"font-size: 60px\"}\n\n1. RNASeq is applicable to noncoding RNAs that are not translated into a protein, but instead, have direct functions\n\n1. Many of these noncoding RNAs affect disease states, including cancer, cardiovascular, and neurological diseases\n:::\n:::\n\n::: footer\nLowe et al., 2017\n:::\n\n:::{.notes}\nTranscriptomics is most commonly applied to the mRNA content of the cell, However\n:::\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}