---
format: 
  revealjs:
    navigation-mode: vertical
    slide-number: false
    width: 1600
    height: 900
    logo: "images/revelo.png"
    footer: "[home page](https://mchiapello.github.io/202304_REVELO_Torvergata/)"
    css: ["css/theme.css", "css/custom.css", "css/styles.css"]
    theme: simple
    controls: true
editor: source
filters:
  - roughnotation
editor_options: 
  chunk_output_type: inline
---

##  {#TitleSlide data-menu-title="TitleSlide" background-image="images/back001.jpg" background-size="cover" background-opacity="0.3"}

```{r setup, include=FALSE}
library(fontawesome)
library(tidyverse)
library(quarto)
library(gt)
library(gtExtras)
library(gtsummary)

# font-family: 'Architects Daughter', cursive;
# font-family: 'Julius Sans One', sans-serif;
# font-family: 'Montserrat', san  s-serif;
# font-family: 'Rock Salt', cursive;
```

<style>
  @import url('https://fonts.googleapis.com/css2?family=Architects+Daughter&family=Julius+Sans+One&family=Montserrat:wght@300&family=Rock+Salt&display=swap');
</style>

::: {style="position: absolute; left: 180px; top: 200px; height: 525px; width: 1500px; background-color: #69b1e9; padding: 20px; padding-left: 50px; border-radius: 5px;"}
[Files and Software]{style="font-size: 120px; font-weight: bold; line-height: 1em; margin: 0px; font-family: 'Architects Daughter', cursive;"}

[Introduzione all'analisi RNASeq in R]{style="font-size: 40px;font-weight: bold;"}

[Dipartimento di Biomedicina e Prevenzione]{style="font-size: 40px;font-weight: bold;"}

<br> <br>

[Marco Chiapello, Revelo Datalab]{style="font-size: 40px; font-weight: bold;"}

[2023-03-31]{style="font-size: 30px;font-weight: bold;"}
:::



# [Files]{.tit .p-span-center}


## Diversi tipi di file

### FASTA file

::: {.callout-important icon="false"}
## Definizione

Il Formato FASTA è un formato di testo per rappresentare le sequenze nucleotidiche o le sequenze aminoacidiche. Sia i nucleotidi che gli aminoacidi sono rappresentati da una singola lettera. Sulla prima linea antecedente alla sequenza nucleotidica/aminoacidica viene riportato il nome della sequenza, preceduto dal simbolo "\>"
:::

I file contenenti queste sequenze possono avere varie desinenze: fasta, fna, ffn, faa, fa, frn

## Diversi tipi di file

### FASTA file

::: {.callout-important icon="false"}
## Definizione

Il Formato FASTA è un formato di testo per rappresentare le sequenze nucleotidiche o le sequenze aminoacidiche. Sia i nucleotidi che gli aminoacidi sono rappresentati da una singola lettera. Sulla prima linea antecedente alla sequenza nucleotidica/aminoacidica viene riportato il nome della sequenza, preceduto dal simbolo "\>"
:::

    >NM_001404729.1 Oryza sativa ribulose bisphosphate carboxylase small chain A
    CTCAACAGCACTGCTACTGGACATACTCTACTACTACTAGCCAGTAAGCTAGCTAACTAACTACGTGGCT
    ATGGCCCCCACCGTGATGGCCTCCTCGGCCACCTCCGTGGCTCCATTCCAAGGGCTCAANNNNNNNNNNN

## Diversi tipi di file

### FASTA file

::: {.callout-important icon="false"}
## Definizione

Il Formato FASTA è un formato di testo per rappresentare le sequenze nucleotidiche o le sequenze aminoacidiche. Sia i nucleotidi che gli aminoacidi sono rappresentati da una singola lettera. Sulla prima linea antecedente alla sequenza nucleotidica/aminoacidica viene riportato il nome della sequenza, preceduto dal simbolo "\>"
:::

    >MCHU - Calmodulin - Human, rabbit, bovine, rat, and chicken
    MADQLTEEQIAEFKEAFSLFDKDGDGTITTKELGTVMRSLGQNPTEAELQDMINEVDADGNGTID
    FPEFLTMMARKMKDTDSEEEIREAFRVFDKDGNGYISAAELRHVMTNLGEKLTDEEVDEMIREA
    DIDGDGQVNYEEFVQMMTAKXXXXXX

## Diversi tipi di file

### FASTA file

È possibile creare dei file che contengano più sequenze concatenando singoli FASTA file.

    >MCHU - Calmodulin - Human, rabbit, bovine, rat, and chicken
    MADQLTEEQIAEFKEAFSLFDKDGDGTITTKELGTVMRSLGQNPTEAELQDMINEVDADGNGTID
    FPEFLTMMARKMKDTDSEEEIREAFRVFDKDGNGYISAAELRHVMTNLGEKLTDEEVDEMIREA
    DIDGDGQVNYEEFVQMMTAK

    >gi|5524211|gb|AAD44166.1| cytochrome b [Elephas maximus maximus]
    LCLYTHIGRNIYYGSYLYSETWNTGIMLLLITMATAFMGYVLPWGQMSFWGATVITNLFSAIPYIGTNLV
    EWIWGGFSVDKATLNRFFAFHFILPFTMVALAGVHLTFLHETGSNNPLGLTSDSDKIPFHPYYTIKDFLG
    LLILILLLLLLALLSPDMLGDPDNHMPADPLNTPLHIKPEWYFLFAYAILRSVPNKLGGVLALFLSIVIL
    GLMPFLHTSKHRSMMLRPLSQALFWTLTMDLLTLTWIGSQPVEYPYTIIGQMASILYFSIILAFLPIAGX
    IENY*

## Diversi tipi di file

### FASTA file

#### Nucleotidi

![](images/nucl.png)

## Diversi tipi di file

### FASTA file

#### Aminoacidi

![](images/amino.png)

## Diversi tipi di file

### FASTA file

::: centerI2
![](images/questions.png)
:::

## Diversi tipi di file

### FASTQ format

::: {.callout-important icon="false"}
## Definizione

Il formato FASTQ è un formato di testo per rappresentare sia le sequenze biologiche (normalmente nucleotidiche) sia il corrispettivo valore di qualità. Sia le sequenze che lo score di qualità sono codificati da una singola lettera (carattere ASCII) per brevità.
:::

## Diversi tipi di file

### FASTQ format

::: {.callout-important icon="false"}
## Definizione

Il formato FASTQ è un formato di testo per rappresentare sia le sequenze biologiche (normalmente nucleotidiche) sia il corrispettivo valore di qualità. Sia le sequenze che lo score di qualità sono codificati da una singola lettera (carattere ASCII) per brevità.
:::

::: f20
Un file FASTQ è identificato da 4 linee:

-   Linea 1: inizia con il simbolo "\@" ed è seguita dall'identificativo della sequenza (come nelle sequenze FASTA)
-   Linea 2: contiene la sequenza nucleotidica
-   Linea 3: inizia con un "+" e può contenere descrizioni aggiuntive della sequenza
-   Linea 4: contiene i valori di qualità dei singoli nucleotidi
:::

## Diversi tipi di file

### FASTQ format

::: {.callout-important icon="false"}
## Definizione

Il formato FASTQ è un formato di testo per rappresentare sia le sequenze biologiche (normalmente nucleotidiche) sia il corrispettivo valore di qualità. Sia le sequenze che lo score di qualità sono codificati da una singola lettera (carattere ASCII) per brevità.
:::

    @SEQ_ID
    GATTTGGGGTTCAAAGCAGTATCGATCAAATAGTAAATCCATTTGTTCAACTCACAGTTT
    +
    !''*((((***+))%%%++)(%%%%).1***-+*''))**55CCF>>>>>>CCCCCCC65

## Diversi tipi di file

### FASTQ format

#### Cosa significa "score di qualità"?

::: f20
Lo score di qualità è usato per identificare la **probabilità di corretta identificazione del corrispondente nucleotide**.
:::

![](images/phred1.png)

::: notes
-   I numeri da 33 a 126 sono i numeri ASCII corrispondenti alla lettera che indicano
-   Score più alto osservato 40, quindi molti si fermano li
:::

## Diversi tipi di file

### FASTQ format

#### Cosa significa "score di qualità"?

::: f20
Lo score di qualità è usato per identificare la **probabilità di corretta identificazione del corrispondente nucleotide**.
:::

::: centerI
![](images/phred2.png)
:::

## Diversi tipi di file

### FASTQ format

I FASTQ file possono avere dimensioni molto grandi, per questo nella maggior parte dei casi non avrete a che fare con ilMioFile.fastq, ma con ilMioFile.fastq.gz.

Questo significa che il file è compresso, quindi non leggibile da un editor di testa senza prima essere de-compresso.

## Diversi tipi di file

### FASTQ file

::: centerI2
![](images/questions.png)
:::

## Diversi tipi di file

### SAM/BAM format

::: {.callout-important icon="false"}
## Definizione

I file SAM (Sequence Alignment Map) sono file di testo creati originariamente per contenere le sequenze biologiche allineate ad una sequenza di riferimento (genoma).
:::

::: f30
-   Il formato è stato sviluppato per il progetto 1000 Genome.
-   Questo formato è largamente usato per le sequenze nucleotiche generate dalle tecnologie NGS.
-   Nella maggior parte dei casi non vi troverete a che fare con un file SAM, ma con un file BAM
:::

## Diversi tipi di file

### SAM/BAM format

#### Differenza tra SAM e BAM?

::: fragment
-   In realtà nessuna! I due file sono identici nel contenuto
-   In pratica il file SAM può essere letto da un editor di testo, mentre il file BAM no.
-   Il BAM è un file binary, cioè machine-readable. È più compresso del file human-readable.
:::

## Diversi tipi di file

### SAM/BAM format

::: f30
I file SAM/BAM consistono in 2 parti una intestazione (header) e un allineamento.

-   L'**intestazione**
    -   (se presente) dev'essere prima dell'allineamento
    -   Ogni riga dell'intestazione inizia con il simbolo "\@"
    -   Una coppia di lettere che segue il simbolo "\@" indica la sezione dell'intestazione

::: code
    @RG     ID:1    SM:C5926_BM_IonCode_0118
    @PG     ID:samtools     PN:samtools    VN:1.16.1    CL:samtools view -H C5926_BM_IonCode_0118.reassembled.bam
:::
:::

::: notes
-   @RG = read group
    -   ID = Read group identifier
    -   SM = Sample
-   @PG = Program
    -   ID = Program record identifier
    -   PN = Program name
    -   VN = software version
    -   Cl = command line
:::

## Diversi tipi di file

### SAM/BAM format

::: f30
I file SAM/BAM consistono in 2 parti una intestazione (header) e un allineamento.

-   L'**allineamento**
:::

![](images/bam2.png){.absolute top="400" left="0" width="700" height="auto"}

![](images/bam1.png){.absolute top="300" right="0" width="350" height="auto"}

::: notes
-   11 campi obbligatori

-   Metadati non obbligatori

-   Concise Idiosyncratic Gapped Alignment Report (CIGAR) string
:::

## Diversi tipi di file

### SAM/BAM format

#### FLAGS

![](images/flags1.png){.absolute left="250" width="600" height="auto"}

::: f20
[Flag calculator](https://broadinstitute.github.io/picard/explain-flags.html)
:::

## Diversi tipi di file

### SAM/BAM format

#### CIGAR

![](images/cigar1.png){.absolute top="250" left="0" width="500" height="auto"}

::: fragment
![](images/cigar2.png){.absolute top="300" right="0" width="400" height="auto"}
:::

::: notes
-   Concise Idiosyncratic Gapped Alignment Report (CIGAR) string
-   Rappresenta l'allineamento di una sequenza al genoma di riferimento
:::

## Diversi tipi di file

### SAM/BAM format

::: centerI2
![](images/questions.png)
:::


## Diversi tipi di file

### BED/GTF/GFF3 formats

::: {.callout-important icon="false"}
## Definizione

Questi sono i tre principali formati di annotazione. Ci sono molte somiglianze ma anche alcune fondamentali differenze.
:::

::: f30
-   BED: permettono un solo livello di complessita, ogni caratteristica può essere divisa in diversi blocchi (linee del file)
-   GTF: permettono 2 livelli di complessità, gli esoni possono essere raggruppati in trascritti e i trascritti in geni
-   GFF3: permettono un numero arbitrari di livelli
:::

## Diversi tipi di file

### BED

::: {.callout-important icon="false"}
## Definizione

I file BED (Browser Extensible Data) sono file di testo creati per descrivere caratteristiche del genoma.
:::

::: fragment
![](images/bed1.png){.absolute top="350" left="20" width="1000" height="auto"}
:::

## Diversi tipi di file

### BED

![](images/bed2.png){.absolute top="150" left="30" width="1200" height="auto"}

## Diversi tipi di file

### BED

::: centerI2
![](images/questions.png)
:::

## Diversi tipi di file

### GTF format

::: {.callout-important icon="false"}
## Definizione

GFF2 or GTF (General Transfer Format) è un formato usato per descrivere due livelli di annotazione: geni e trascritti.
:::

::: fragment
![](images/gtf1.png){.gft1 .absolute top="360" left="20" width="1200" height="auto"}
:::

## Diversi tipi di file

### GTF format

::: {.callout-important icon="false"}
## Definizione

GFF2 or GTF (General Transfer Format) è un formato usato per descrivere due livelli di annotazione: geni e trascritti.
:::

![](images/gtf2.png){.absolute top="360" left="0" width="1200" height="auto"}

## Diversi tipi di file

### GTF format
::: centerI2
![](images/questions.png)
:::

## Diversi tipi di file

### GFF3 format

::: {.callout-important icon="false"}
## Definizione

GFF3 (General Feature Format) è un file ti testo che contiene informazioni su ogni caratteristica delle sequenze nucleiche o aminiacidiche che descrive. CDS, microRNAs, binding domains, ORFs e molto altro possono essere gestite da questo formato
:::

#### Campi{.center}

::::{.columns}

:::{.column width="33%" .f20}
- Column 1: "seqid"
- Column 2: "source"
- Column 3: "type"
:::

:::{.column width="33%" .f20}
- Column 4:"start"
- Column 5: "end"
- Column 6: "score"
:::

:::{.column width="33%" .f20}
- Column 7: "strand"
- Column 8: "phase"
- Column 9: "attributes"
:::

::::


## Diversi tipi di file

### GFF3 format

![](images/gff31.png){.absolute top="240" left="0" width="490" height="auto"}


![](images/gff32.png){.absolute top="170" left="500" width="600" height="auto"}



:::{.notes}
-   It encodes three alternatively-spliced transcripts named EDEN.1, EDEN.2 and EDEN.3,
-   **EDEN.3** has two alternative translational **start sites** leading to the generation of two protein coding sequences.
:::

## Diversi tipi di file

### GFF3 format
::: centerI2
![](images/questions.png)
:::

# [Software]{.tit .p-span-center}

## Diversi Software
### Terminal

<br>

:::{.tcenter}
[DEMO]{.tit .p-spam.center}

[material](https://swcarpentry.github.io/shell-novice/)
:::


## Diversi Software
### Pre-alignment QC

:::{.tcenter}
[FastQC]{.tit .p-spam.center}

<br>

[[https://www.bioinformatics.babraham.ac.uk/projects/fastqc/](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/)]{.p-spam.center}

<br>

[material](https://mchiapello.github.io/202010_VirusDetection/Pres/M5_FastQC.html#2)

:::




## Diversi Software



## Diversi Software
### Trim/filter reads

Questo passaggio è importante per 

1. rimuovere i primer adapters

1. Filtrare le reads di bassa qualità (se presenti)

La rimozione delle reads di bassa qualità semplifica l'analisi a valle



## Diversi Software
### Allineamento al genoma

::: {.callout-important icon="false"}
## Definizione
L'allineamenro delle reads al genoma permette di individuare le differenze tra le reads e il genoma di riferimento
:::

:::{.centerI2}
![](images/mapping.png)
:::

## Diversi Software
### Allineamento al genoma
#### STAR


## Diversi Software
### Allineamento al genoma
#### Quasi mapping

1. Kallisto

1. Salmon


## Diversi Software
### Espressione differenziale





#  {background-image="images/qmark.jpg" background-size="cover" background-opacity="0.7"}

::: {style="position: absolute; left: 980px; top: 450px;"}
[Domande?]{style="font-size: 130px; font-weight: bold; color: white"}
:::



